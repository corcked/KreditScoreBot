# –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è KreditScore Bot

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏
- üá∑üá∫ –†—É—Å—Å–∫–∏–π (ru) - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫
- üá∫üáø –£–∑–±–µ–∫—Å–∫–∏–π (uz) - –ª–∞—Ç–∏–Ω–∏—Ü–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **–°–∏—Å—Ç–µ–º–∞ i18n** (`src/bot/i18n.py`)
   - –§—É–Ω–∫—Ü–∏—è `simple_gettext()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
   - Middleware –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —è–∑—ã–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏–∑ .po —Ñ–∞–π–ª–æ–≤ –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è

2. **–§–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤**
   - `src/bot/i18n/ru.po` - —Ä—É—Å—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã
   - `src/bot/i18n/uz.po` - —É–∑–±–µ–∫—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã
   - –ë–æ–ª–µ–µ 500 –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ

3. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ –º–æ–¥—É–ª—è—Ö**
   - –í—Å–µ handler'—ã –ø–æ–ª—É—á–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ–≤–æ–¥–∞ `_` —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä
   - Core –º–æ–¥—É–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `translate`
   - Keyboards –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≤–æ–¥—è—Ç –≤—Å–µ —Ç–µ–∫—Å—Ç—ã

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –í handler'–∞—Ö –±–æ—Ç–∞

```python
@router.message(Command("help"))
async def show_help(message: types.Message, _: callable):
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é _ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞
    help_text = f"""
    üìö **{_('Bot Usage Guide')}**
    
    **{_('Main commands')}:**
    /start - {_('Start using the bot')}
    """
    await message.answer(help_text)
```

### –í core –º–æ–¥—É–ª—è—Ö

```python
# Core –º–æ–¥—É–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä translate
def validate_loan_parameters(
    loan_type: LoanType, 
    amount: Decimal, 
    rate: Decimal, 
    term_months: int,
    translate: Optional[Callable[[str], str]] = None
) -> Dict[str, Any]:
    if amount <= 0:
        msg = translate('Loan amount must be positive') if translate else 'Loan amount must be positive'
        errors.append(msg)
```

### –í –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞—Ö

```python
@staticmethod
def region_choice(_: Callable[[str], str]) -> InlineKeyboardMarkup:
    regions = [
        (_('Tashkent'), Region.TASHKENT.value),
        (_('Andijan'), Region.ANDIJAN.value),
        # ...
    ]
```

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤

### 1. –î–æ–±–∞–≤–∏—Ç—å –≤ .po —Ñ–∞–π–ª—ã

```po
# –í src/bot/i18n/ru.po
msgid "New feature"
msgstr "–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è"

# –í src/bot/i18n/uz.po
msgid "New feature"  
msgstr "Yangi funksiya"
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–æ–¥–µ

```python
# –í handler'–µ
text = _('New feature')

# –í core –º–æ–¥—É–ª–µ
text = translate('New feature') if translate else 'New feature'
```

## –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫

–î–ª—è —Å—Ç—Ä–æ–∫ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ `.format()`:

```python
# –í .po —Ñ–∞–π–ª–µ
msgid "Welcome, {name}!"
msgstr "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {name}!"

# –í –∫–æ–¥–µ
welcome_text = _('Welcome, {name}!').format(name=user_name)
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
pytest tests/unit/test_i18n_completeness.py -v

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤
pytest tests/unit/test_i18n_completeness.py::TestI18nCompleteness -v

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ö–∞—Ä–¥–∫–æ–¥–∞
pytest tests/unit/test_i18n_completeness.py::TestHardcodedStringsRemoved -v
```

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è

1. **–ü–æ–ª–Ω–æ—Ç–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤**
   - –í—Å–µ –∫–ª—é—á–∏ –∏–∑ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –µ—Å—Ç—å –≤ —É–∑–±–µ–∫—Å–∫–æ–º
   - –í—Å–µ –∫–ª—é—á–∏ –∏–∑ —É–∑–±–µ–∫—Å–∫–æ–≥–æ –µ—Å—Ç—å –≤ —Ä—É—Å—Å–∫–æ–º
   - –ù–µ—Ç –ø—É—Å—Ç—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤

2. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**
   - –§–æ—Ä–º–∞—Ç–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã
   - .po —Ñ–∞–π–ª—ã –≤–∞–ª–∏–¥–Ω—ã –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π

3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ö–∞—Ä–¥–∫–æ–¥–∞**
   - –í handler'–∞—Ö –Ω–µ—Ç —Ä—É—Å—Å–∫–∏—Ö —Å—Ç—Ä–æ–∫
   - –í keyboards –Ω–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–π —Ä–µ–≥–∏–æ–Ω–æ–≤
   - –í core –º–æ–¥—É–ª—è—Ö –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö

## –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–∂–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å .po —Ñ–∞–π–ª—ã –≤ .mo:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å gettext tools
apt-get install gettext  # Ubuntu/Debian
brew install gettext      # macOS

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è
msgfmt src/bot/i18n/ru.po -o src/bot/i18n/ru.mo
msgfmt src/bot/i18n/uz.po -o src/bot/i18n/uz.mo
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –ø–µ—Ä–µ–≤–æ–¥—ã –≤ –æ–±–∞ —è–∑—ã–∫–∞**
   - –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–ª—è–π—Ç–µ –≤ ru.po –∏ uz.po

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –∫–ª—é—á–∏**
   - –ü–ª–æ—Ö–æ: `msgid "msg1"`
   - –•–æ—Ä–æ—à–æ: `msgid "Welcome message"`

3. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç**
   - –î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ .po —Ñ–∞–π–ª—ã –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤
   - –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã

4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–≤–æ–¥—ã**
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ–±–∞ —è–∑—ã–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

5. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é
   - –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å—Ç–∏–ª–µ–º –ø–µ—Ä–µ–≤–æ–¥–æ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

1. **–û–±—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã UI**
   - –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (Back, Cancel, Next)
   - –ú–µ–Ω—é –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

2. **–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∑–∞—è–≤–∫–∞**
   - –¢–∏–ø—ã –∫—Ä–µ–¥–∏—Ç–æ–≤
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫—Ä–µ–¥–∏—Ç–∞
   - –†–∞—Å—á–µ—Ç –ü–î–ù

3. **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**
   - –í–æ–ø—Ä–æ—Å—ã –∞–Ω–∫–µ—Ç—ã
   - –ù–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π
   - –†–µ–≥–∏–æ–Ω—ã

4. **–°–∫–æ—Ä–∏–Ω–≥**
   - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏
   - –£—Ä–æ–≤–Ω–∏ —Å–∫–æ—Ä–∏–Ω–≥–∞
   - –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–ª–ª–æ–≤

5. **–í–∞–ª–∏–¥–∞—Ü–∏—è**
   - –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —è–∑—ã–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```python
# –í handler'–µ
user_lang = await get_user_language(db, message.from_user.id)
print(f"User language: {user_lang}")
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤

```python
from src.bot.i18n import TRANSLATIONS
print(f"Loaded languages: {list(TRANSLATIONS.keys())}")
print(f"Russian keys: {len(TRANSLATIONS['ru'])}")
print(f"Uzbek keys: {len(TRANSLATIONS['uz'])}")
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

```python
# –í–∫–ª—é—á–∏—Ç—å –≤ i18n.py –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
def simple_gettext(lang_code: str, message: str) -> str:
    logger.debug(f"Translating '{message}' to {lang_code}")
    # ...
```

## –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã

| –ö–ª—é—á | –†—É—Å—Å–∫–∏–π | –£–∑–±–µ–∫—Å–∫–∏–π |
|------|---------|-----------|
| Back | –ù–∞–∑–∞–¥ | Orqaga |
| Cancel | –û—Ç–º–µ–Ω–∞ | Bekor qilish |
| Main menu | –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é | Asosiy menyu |
| Settings | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ | Sozlamalar |
| Yes | –î–∞ | Ha |
| No | –ù–µ—Ç | Yo'q |
| sum | —Å—É–º | so'm |
| months | –º–µ—Å—è—Ü–µ–≤ | oy |

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞

1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π .po —Ñ–∞–π–ª:
   ```bash
   cp src/bot/i18n/ru.po src/bot/i18n/en.po
   ```

2. –û–±–Ω–æ–≤–∏—Ç—å i18n.py:
   ```python
   SUPPORTED_LANGUAGES = ['ru', 'uz', 'en']
   ```

3. –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –≤ –Ω–æ–≤–æ–º .po —Ñ–∞–π–ª–µ

4. –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞

5. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏–∑:
- .po/.mo —Ñ–∞–π–ª–æ–≤ (gettext)
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è Python
- –í–Ω–µ—à–Ω–∏—Ö API (—Ç—Ä–µ–±—É–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏)
- –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Ç—Ä–µ–±—É–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏)

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ü–µ—Ä–µ–≤–æ–¥—ã –∫–µ—à–∏—Ä—É—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –ù–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –¥–∏—Å–∫—É –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–≤–æ–¥–µ
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥ (~0.001ms)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö .mo —Ñ–∞–π–ª–æ–≤ –¥–ª—è –µ—â–µ –±–æ–ª—å—à–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏